Implemented auth endpoints and middleware